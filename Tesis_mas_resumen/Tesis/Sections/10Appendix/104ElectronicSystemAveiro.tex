The electronics of the TRITIUM-Aveiro prototype consists of several PCB and is divided in two parts:
\begin{enumerate}
\item{} A PCB designed to power the PMTs with a negative high voltage consists of several C11152-01  HV power supplies from Hamamatsu Photonics \cite{PowerSupplyAveiroDataSheet}. This PCB is controled by a MAX5500 DAC\footnote{DAC, Digital-to-analog converter} from Maxim Integrated \cite{MAX5500DataSheet}. Its electronic scheme is shown in Figure \ref{fig:HVElectronicAveiro}.  An Arduino Mega controls the DAC communication and is connected to a Raspberry Pi that runs the whole system.

A graphical interface, shown Figure \ref{subfig:GUI}, was developed to set up the different options in an easy way.

\begin{figure}
\centering
    \begin{subfigure}[b]{0.8\textwidth}
    \centering
    \includegraphics[width=\textwidth]{9Appendix/94AveiroElectronics/TritiumHV-Board.pdf}  
    \caption{\label{subfig:ElectronicSchemeHVBoard}}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.6\textwidth}
    \centering
    \includegraphics[width=\textwidth]{9Appendix/94AveiroElectronics/GUIHVBoard.png}  
    \caption{\label{subfig:GUI}}
    \end{subfigure}
 \caption{a) The electronic scheme of the PCB designed to power the PMTs of Aveiro prototype b) The graphical user interface developed to control the prototype.}
 \label{fig:HVElectronicAveiro}
\end{figure}

\item{} An electronic chain which consists of several PCBs that process and analyze the system signals. Its electronic scheme is shown in Figure \ref{fig:ElectronicSchemCounterBoard}. This electronics consists of two lines for the PMT signals of the prototype and another one for the PMT of an active veto.

\begin{figure}[h]
\centering
\includegraphics[scale=0.45]{9Appendix/94AveiroElectronics/ElectronicSchemeCounterBoard.png}
\caption{Electronic scheme that process and analyze the signal of the TRITIUM-Aveiro prototype. \label{fig:ElectronicSchemCounterBoard}}
\end{figure}

To test this electronic chain, a plastic scintillator of $10 \times 10 \times 1~\cm^3$ was used to simulate a veto signal. Four different $50\times 30 \times 2~\cm^3$  rectangular vetos made of plastic scintillator from Saint-Gobain \cite{VetoAveiro} are being built. The vetos are read out by a $2$" R2154-02 PMTs from Hamamatsu Photonics \cite{DataSheetPMTsAveiro}. %The output signals of these PMTs go into an OR gate, which output is connected to the veto line shown in Figure \ref{fig:ElectronicSchemCounterBoard}. Thus, each veto is read in anticoincidence with the TRITIUM-Aveiro prototype.

The two lines corresponding to the PMTs attached to the prototype are equal. Each of these signals are preamplified and shaped by a CR111 preamplifier from CREMAT Inc. \cite{CREMATPreAmplifierDataSheet}. To reduce electronic noise and signal loss, both preamplifiers are connected as close as possible to the PMTs and they are placed inside aluminium boxes which act as Faraday cages. Each preamplifier is followed by a differentiator stage which reduces the width of the signal and an OPA656 amplifier from Texas Instruments \cite{OPA656}. A LT111 fast comparator from Linear Technology \cite{LT111} is used to set a threshold that removes PMT signals with low amplitude (dark counts of the PMT). A MAX5500 DAC is used to configure the thresholds. As the time width of the preamplifier output signal is $200~\mu\second$, a second differentiator was included to reduce random coincidences. To restore a 5V square signal a second comparator was added. Finally a tunable pulse stretcher based on an SN74AHC1 OR gate from Texas Instruments \cite{Stretcher} sets the signal time width to $100~\nano\second$. The time coincidence window of the system is $200~\nano\second$.

The third line consists of an inverter, which gives a $0~\volt$ when there is a veto signal and $5~\volt$ otherwise. A stretcher sets the signal time width to $100~\nano\second$.

The signals from the three lines are introduced into a 3-input SN74LVC1G11 AND gate from Texas Instruments \cite{ANDGate} which generate an output signal when both PMT signals are in coincidence and the veto signal are in anti-coincidence. The output signal of this stage is connected to a pulse counter. 

The GPIO pins of a Raspberry Pi are used to communicate with the system and configure the threshold levels. A graphical user interface, shown in Figure \ref{fig:GUIcounts}, was developed to set the counter system in an easy way.

 \begin{figure}[h]
\centering
\includegraphics[scale=0.45]{9Appendix/94AveiroElectronics/CounterGUI.png}
\caption{Graphical user interface used to manage the counter system. \label{fig:GUIcounts}}
\end{figure}

%Besides counting, this electronic system includes a voltage follower circuit connected to the preamplifier output signal that produces an energy spectrum for each PMT.

%It is important to note that, although this system has a graphical user interface that allows comfortable control of the system, the usual way in which it is controlled is remotely through the computer terminal.

In Figure \ref{fig:ScreenshotElectronic}, screenshots for accepted an rejected events are displayed.

%In Figure \ref{fig:ScreenshotElectronic} two screenshots are shown to demostrate two different situations of this system. There, we have four different signals. The yellow and cyan signal are input signals of the AND-Gate, which come from the PMT signals of the prototype. The pink signal is the third remaining input signal of the AND-Gate, which come from the PMT signal of the veto. The last signal, green, is the output signal of the AND-Gate.

\begin{figure}
\centering
    \begin{subfigure}[b]{0.42\textwidth}
    \centering
    \includegraphics[width=\textwidth]{9Appendix/94AveiroElectronics/Event_accepted_Aveiro_prototype.png}  
    \caption{\label{subfig:TrueTritiumEvent}}
    \end{subfigure}
    \hfill
    \begin{subfigure}[b]{0.42\textwidth}
    \centering
    \includegraphics[width=\textwidth]{9Appendix/94AveiroElectronics/Event_rejected_Aveiro_prototype.png}  
    \caption{\label{subfig:FalseTritiumEvent}}
    \end{subfigure}
 \caption{a) Tritium event accepted as veto has not detected it. b) Background event rejected because veto has fired.}
 \label{fig:ScreenshotElectronic}
\end{figure}


%As can be seen, in Figure \ref{subfig:TrueTritiumEvent} both PMTs of the prototype have detect a time coincident event, which has not been detected for the veto, so this event is counted. In Figure \ref{subfig:FalseTritiumEvent}, a time coincidence event has been observed in the three PMTs, which means that it is a cosmic event, so this event is not counted.
\end{enumerate}